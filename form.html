<!DOCTYPE html>
<html>

<head>
  <title>Leaver form</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
  <style>
    html,
    body {
      min-height: 100%;
      padding: 0;
      margin: 0;
      font-family: Roboto, Arial, sans-serif;
      font-size: 14px;
      color: #666;
    }

    h2 {
      font-weight: 400;
      color: #FFF;
      margin-left: -40px;
      margin-bottom: -25px;
      padding-top: 4px;
    }

    p {
      margin: 0 0 5px;
    }

    .main-form {
      display: inline-block;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: #1c87c9;
      width: 100%;
    }

    form {
      padding: 25px;
      margin: auto;
      margin-top: 2px;
      box-shadow: 0 2px 5px #f5f5f5;
      background: #f5f5f5;
      width: 1000px;
    }

    .fas {
      margin: 25px 10px 0;
      font-size: 72px;
      color: #fff;
    }

    .fa-envelope {
      transform: rotate(-20deg);
    }

    .fa-at,
    .fa-mail-bulk {
      transform: rotate(10deg);
    }

    input,
    textarea {
      width: 300px;
      padding: 8px;
      margin-bottom: 12px;
      border: 1px solid #1c87c9;
      outline: none;
      display: block;
    }

    select {
      width: 45px;
      height: 30px;
      margin-bottom: 12px;
      padding: 4px;
      border: 1px solid #1c87c9;
      outline: none;
      background: #fff;
    }

    textarea {
      width: 97%;
      margin-bottom: 4px;
      margin-top: 10px;
    }

    .addressfields {
      margin-right: 100px;
      margin-bottom: 6px;
    }

    input::placeholder {
      color: #666;
    }

    button {
      width: 300px;
      padding: 10px;
      border: none;
      background: #1c87c9;
      font-size: 16px;
      font-weight: 400;
      color: #fff;
      margin-top: 20px;
    }

    button:hover {
      background: #2371a0;
    }

    button.linkbutton {
      font-family: "Verdana"sans-serif;
      font-size: 14px;
      text-align: left;
      color: #0000ff;
      background: none;
      margin: 0;
      padding: 0;
      border: none;
      cursor: pointer;
      text-decoration: underline;
      -moz-user-select: text;
    }

    @media (min-width: 568px) {
      .main-form {
        flex-direction: row;
      }

      .dropbtn {
        background-color: #fff;
        color: #666;
        padding: 4px 10px;
        border: 1px solid #1c87c9;
        font-family: Roboto, Arial, sans-serif;
        font-size: 14px;
        color: #666;
        margin-bottom: 15px;
      }

      .dropdown {
        position: relative;
        display: inline-block;
        margin-right: 5px;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        margin-top: -20px;
      }

      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .center_form {
        display: flex;
        justify-content: center;
        align-items: center;
      }
    }

    .dropdown-content a:hover {
      background-color: #ddd;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }

    .dropdown:hover .dropbtn {
      background-color: #ddd;
    }

    .alldropdowns {
      margin-bottom: 5px;
    }

    .loader {
      border: 8px solid #ff0000;
      border-radius: 50%;
      border-top: 8px solid #fff;
      border-bottom: 8px solid #0000ff;
      margin-left: -30px;
      width: 8px;
      height: 8px;
      -webkit-animation: spin 2s linear infinite;
      /* Safari */
      animation: spin 2s linear infinite;
      position: relative;
      display: inline-block;
    }

    /* Safari */
    @-webkit-keyframes spin {
      0% {
        -webkit-transform: rotate(0deg);
      }

      100% {
        -webkit-transform: rotate(360deg);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body>
  <div class="center_form">
    <div class="main-form">
      <div style="display:flex;width:100%;margin-top:0px;margin-bottom:-50px;">
        <image src="https://drive.google.com/uc?export=view&id=1kMf2uvo5rmTi2YkjVWTP90d9STbF2Mwx" style="vertical-align:middle;display:inline;margin-left:7%;" width="320px" height="116px" />
        <h2 style="margin-left:-55px;font-weight:bold">Record of time taken for Medical, Dental or Family Emergencies</h2>
      </div>
      <form id="main" action='https://script.google.com/a/calancs.org.uk/macros/s/AKfycbwYbZ4dCijoUUj3EVGOMf08VFyEU4fnfwa8-yWh0xHhbfmCK0A/exec' method='post'>
        <div class="info">
          <div style="display:flex;">
            <label style="margin-top:8px;text-align:left;width:50px;">Name:</label>
            <input onfocus="this.removeAttribute('placeholder')" onblur="this.setAttribute('placeholder','* First and Last Names')" id="name_001" name="name_001" style="width:200px;" type="search" placeholder="* First and Last Names" required
              pattern="^[a-zA-Z\s]*$" oninvalid="this.setCustomValidity('Name required')" oninput="this.setCustomValidity('');document.getElementById('btnsubmit').setAttribute('novalidate', true);">
            <label style="margin-top:8px;text-align:left;width:40px;margin-left:30px;">Email:</label>
            <input id="email_001" readonly name="email_001" style="width:200px;margin-left:5px;border:none;background:none;font-family: Roboto, Arial, sans-serif;font-size: 14px;color: #324da8;" type="search" value="<?=requestoremail?>">
            <label style="margin-top:8px;text-align:left;width:40px;margin-left:10px;">Manager:</label>
            <input id="managername" readonly name="managername" style="margin-left:15px;width:150px;border:none;background:none;font-family: Roboto, Arial, sans-serif;font-size: 14px;color: #324da8;" type="search" value="<?=manager?>">
            <label style="margin-top:10px;text-align:left;width:160px;margin-left:25px;">Confirmed with Manager?</label>
            <div style="display:inline;margin-top:10px;">
              <input id="checkbox_001" name="checkbox_001" style="width:40px;" type="checkbox" oninvalid="this.setCustomValidity('Please confirm you have confirmed this with your Manager')" oninput="this.setCustomValidity('');" required>
            </div>
          </div>
          <!-- *********************************************************** Time Taken ******************************************************************** -->
          <div style="display:inline;">
            <p style="font-size:16px;color:#324da8;"><b>Step 1: Please record the time you need for medical, dental or family emergencies below:</b></p>
          </div>
          <div id="timeTakenSection" style="border-width:2px;border-style:groove;padding:15px;">
            <div style="display:flex; margin-top:15px;">
              <label style="margin-top:8px;text-align:left;width:54px;">Date:</label>
              <input id="dateTimeTaken" onfocus="clearStatus('hoursTakenAdded')" name="startingdate" style="width:150px;" type="date" oninvalid="this.setCustomValidity('Date required')" oninput="this.setCustomValidity('')" required>
              <label style="margin-top:5px;text-align:left;width:40px;margin-left:15px;margin-right:5px;">Start:</label>
              <select id="starthrs" name="starthrs" onclick="clearStatus('hoursTakenAdded');setHrsTaken();">
                <option value="0">00</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
              </select>
              <label style="text-align:center;width:10px;font-weight:bold;font-size:18px;vertical-align:middle;margin-top:3px;">:</label>
              <select id="startmins" name="startmins" onclick="clearStatus('hoursTakenAdded');setHrsTaken();">
                <option value="0">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
              <label style="margin-top:5px;text-align:left;width:30px;margin-left:25px;margin-right:5px;">End:</label>
              <select id="endhrs" name="endhrs" onclick="clearStatus('hoursTakenAdded');setHrsTaken();">
                <option value="0">00</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
              </select>
              <label style="text-align:center;width:10px;font-weight:bold;font-size:18px;vertical-align:middle;margin-top:3px;">:</label>
              <select id="endmins" name="endmins" onclick="clearStatus('hoursTakenAdded');setHrsTaken();">
                <option value="0">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
              <!--<a href="#" style="margin-left:10px;margin-top:8px;" onclick="checkTimeTaken();return false;">Add</a>-->
              <button style="margin-left:10px;margin-top:2px;height:28px;width:80px;font-size:14px;line-height: 10px;" onclick="checkTimeTaken();return false;" formNoValidate>Add</button>
              <label style="text-align:center;margin-top:8px;text-align:left;width:90px;margin-left:75px;margin-right:5px;">Time taken:</label>
              <input id="totalhrstaken" name="totalhrstaken" style="width:40px;background:none;height:15px;" readonly>
            </div>
            <div style="display:inline; margin-top:30px;">
              <label style="margin-top:8px;text-align:left;width:40px;margin-right:3px;">Details:</label>
              <select id="takenhours" name="takenhours" style="width:450px;height:40px;">
              </select>
              <a id="lnkdeleteTimeTaken" href="#" style="margin-left:10px;margin-top:8px;visibility:hidden;" onclick="clearStatus('hoursTakenAdded');deleteTimeTaken();return false;">Delete</a>
              <label style="margin-top:8px;text-align:right;width:120px;margin-right:12px;margin-left:125px;">Total time taken:</label>
              <input id="runningtotalTimetaken" name="runningtotalTimetaken" style="text-align:center;width:40px;background:none;color:red;font-weight:bold;height:15px;display:inline;" readonly>
            </div>
            <br>
            <label id="hoursTakenAdded" style="margin-top:5px;text-align:left;width:200px;margin-left:50px;margin-right:10px;color:blue;"></label>
          </div>
        </div> <!-- End Time Taken -->
        <div style="height:20px;"> </div>
        <div id="timereason" style="display:none;">
          <div style="display:inline;">
            <p style="font-size:16px;color:#324da8;"><b>Step 2: Do you prefer the above hours to be recorded as unpaid/annual leave or worked at an alternative time?</b></p>
          </div>

          <div style="display:flex;border-width:2px;border-style:groove;padding:15px;">
            <label for="unpaidleave">Unpaid leave</label>
            <input type="radio" id="unpaidleave" onclick="timeoffreason()" name="hoursoffreason" value="unpaid" oninvalid="this.setCustomValidity('Choose an option')" oninput="this.setCustomValidity('')" style="width:20px;" required>
            <label for="annualleave">Annual leave</label>
            <input type="radio" onclick="timeoffreason()" id="annualleave" name="hoursoffreason" value="annual" style="width:20px;">
            <label for="makingup">Worked at alternate time</label>
            <input type="radio" onclick="timeoffreason()" id="makingup" name="hoursoffreason" value="makeup" style="width:20px;">
            <br>
            <label id="hoursoffreasonstatus" style="margin-top:0px;text-align:left;width:350px;margin-left:20px;color:blue;"></label>
          </div>
        </div>
        <div style="height:20px;"> </div>
        <!-- *********************************************************** Time Offered ******************************************************************** -->
        <div id="timeOfferedSection" style="display:none;">
          <div style="display:inline;">
            <p style="font-size:16px;color:#324da8;"><b>Step 3: Please enter time you would like to work to balance time recorded above (subject to approval):</b></p>
          </div>
          <div style="border-width:2px;border-style:groove;padding:15px;">
            <div style="display:flex; margin-top:15px;">
              <label style="margin-top:8px;text-align:left;width:54px;">Date:</label>
              <input id="dateTimeOffered" onfocus="clearStatus('hoursOfferedAdded')" name="startingdate" style="width:150px;" type="date" oninvalid="this.setCustomValidity('Date required')" oninput="this.setCustomValidity('')" required>
              <label style="margin-top:5px;text-align:left;width:40px;margin-left:15px;margin-right:5px;">Start:</label>
              <select id="starthrsOffered" name="starthrsOffered" onclick="clearStatus('hoursOfferedAdded');setHrsOffered();">
                <option value="0">00</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
              </select>
              <label style="text-align:center;width:10px;font-weight:bold;font-size:18px;vertical-align:middle;margin-top:3px;">:</label>
              <select id="startminsOffered" name="startminsOffered" onclick="clearStatus('hoursOfferedAdded');setHrsOffered();">
                <option value="0">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
              <label style="margin-top:5px;text-align:left;width:30px;margin-left:25px;margin-right:5px;">End:</label>
              <select id="endhrsOffered" name="endhrsOffered" onclick="clearStatus('hoursOfferedAdded');setHrsOffered();">
                <option value="0">00</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
              </select>
              <label style="text-align:center;width:10px;font-weight:bold;font-size:18px;vertical-align:middle;margin-top:3px;">:</label>
              <select id="endminsOffered" name="endminsOffered" onclick="clearStatus('hoursOfferedAdded');setHrsOffered();">
                <option value="0">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
              <button style="margin-left:10px;margin-top:2px;height:28px;width:80px;font-size:14px;line-height: 10px;" onclick="checkTimeOffered();return false;" formNoValidate>Add</button>
              <label style="text-align:center;margin-top:8px;text-align:left;width:90px;margin-left:75px;margin-right:5px;">Time offered:</label>
              <input id="totalhrsoffered" name="totalhrsoffered" style="width:40px;background:none;height:15px;" readonly>
            </div>
            <div style="display:inline; margin-top:30px;">
              <label style="margin-top:8px;text-align:left;width:40px;margin-right:3px;">Details:</label>
              <select id="offeredhours" name="offeredhours" style="width:450px;height:40px;">
              </select>
              <a id="lnkdeleteTimeOffered" href="#" style="margin-left:10px;margin-top:8px;visibility:hidden;" onclick="clearStatus('hoursOfferedAdded');deleteTimeOffered();return false;">Delete</a>
              <label style="margin-top:8px;text-align:right;width:120px;margin-right:12px;margin-left:114px;">Total time offered:</label>
              <input id="runningtotalTimeoffered" name="runningtotalTimeoffered" style="text-align:center;width:40px;color:green;background:none;font-weight:bold;height:15px;display:inline;" readonly>
            </div>
            <br>
            <label id="hoursOfferedAdded" style="margin-top:5px;text-align:left;width:200px;margin-left:50px;margin-right:10px;color:blue;"></label>
          </div>
        </div>
        <!-- End Time Offered -->
        <div style="clear:both;"></div>
        <div style="width:100%;display:inline-block;">
          <button id="btnsubmit" style="float:left;background:#ccc;" disabled onclick="formsubmitted();">Submit</button>
          <br>
          <br>
          <label id="hoursNotEqualWarning" style="font-weight:bold;font-size:16px;display:none;margin-top:40px;text-align:left;width:200px;margin-left:50px;margin-right:10px;color:red;">Hours offered and taken need to be equal before
            submitting.</label>
          <div id="progress" style="float:left;display:none;margin-left:60px;margin-top:15px;">
            <div style="float:left;display:inline;color:red;margin-right:40px;margin-top:10px;">Submitting please wait ...</div>
            <div class="loader"></div>
          </div>
        </div>
        <input type="hidden" id="hdntotalTimeTaken" name="hdntotalTimeTaken">
        <input type="hidden" id="hdntotalTimeOffered" name="hdntotalTimeOffered">
        <input type="hidden" id="hdnTimeTakenReason" name="hdnTimeTakenReason">
        <input type="hidden" id="hdnTimeTakenList" name="hdnTimeTakenList">
        <input type="hidden" id="hdnTimeOfferedList" name="hdnTimeOfferedList">
        <input type="hidden" id="hdnManager" name="hdnManager">
      </form>
    </div>
  </div>
</body>

<script>
  function sortList(selectlist) {
    var sortByDate = function(a, b) {
      return new Date(a.value) - new Date(b.value);
    }
    var list = document.getElementById(selectlist);
    var options = list.getElementsByTagName("option");
    // NodeList in previous step is an
    // object and needs to be converted to an array.
    var optionsArray = Array.prototype.slice.call(options);
    // Use the sort method (in-place sorting)
    optionsArray.sort(sortByDate);
    // re-insert the sorted nodes
    for (var i = 0; i < optionsArray.length; i++) {
      list.appendChild(optionsArray[i]);
    }
  }

  function formsubmitted() {
    var inpName = document.getElementById("name_001");
    var inpEmail = document.getElementById("email_001");
    var inpCheckedWithManager = document.getElementById("checkbox_001");
    if (inpName.checkValidity() && inpCheckedWithManager.checkValidity()) {
      if (document.getElementById("unpaidleave").checked) {
        document.getElementById("hdnTimeTakenReason").value = "Unpaid Leave";
        var hrstakenSelect = document.getElementById("takenhours");
        var hrstakenString = " ";
        for (i = 0; i < hrstakenSelect.length; i++) {
          if (i < hrstakenSelect.length - 1) {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "") + "@";
          } else {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "");
          }
        }
        document.getElementById("hdnTimeTakenList").value = hrstakenString;
        document.getElementById('btnsubmit').formNoValidate = true;
        document.getElementById("btnsubmit").disabled = true;
        document.getElementById("progress").style.display = 'inline';
        document.getElementById("main").submit();
      } else if (document.getElementById("annualleave").checked) {
        document.getElementById("hdnTimeTakenReason").value = "Annual Leave"
        var hrstakenSelect = document.getElementById("takenhours");
        var hrstakenString = " ";
        for (i = 0; i < hrstakenSelect.length; i++) {
          if (i < hrstakenSelect.length - 1) {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "") + "@";
          } else {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "");
          }
        }
        document.getElementById("hdnTimeTakenList").value = hrstakenString;
        document.getElementById('btnsubmit').formNoValidate = true;
        document.getElementById("btnsubmit").disabled = true;
        document.getElementById("progress").style.display = 'inline';
        document.getElementById("main").submit();
      } else if (document.getElementById("makingup").checked) {
        document.getElementById("hdnTimeTakenReason").value = "Worked at alternate time"
        var hrstakenSelect = document.getElementById("takenhours");
        var hrstakenString = " ";
        for (i = 0; i < hrstakenSelect.length; i++) {
          if (i < hrstakenSelect.length - 1) {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "") + "@";
          } else {
            hrstakenString += hrstakenSelect.options[i].text.replace("From: ", "").replace("Total: ", "");
          }
        }
        document.getElementById("hdnTimeTakenList").value = hrstakenString;
        var hrsofferedSelect = document.getElementById("offeredhours");
        var hrsofferedString = " ";
        for (i = 0; i < hrsofferedSelect.length; i++) {
          if (i < hrsofferedSelect.length - 1) {
            hrsofferedString += hrsofferedSelect.options[i].text.replace("From: ", "").replace("Total: ", "") + "@";
          } else {
            hrsofferedString += hrsofferedSelect.options[i].text.replace("From: ", "").replace("Total: ", "");
          }
        }
        document.getElementById("hdnTimeOfferedList").value = hrsofferedString;
        document.getElementById('btnsubmit').formNoValidate = true;
        document.getElementById("btnsubmit").disabled = true;
        document.getElementById("progress").style.display = 'inline';
        document.getElementById("main").submit();
      }
    }
  }

  function formatDate(thedate) {
    let current_datetime = new Date(thedate)
    var day;
    var month;
    if (current_datetime.getDate().toString().length < 2) {
      day = "0" + current_datetime.getDate();
    } else {
      day = current_datetime.getDate();
    }
    var currentmonth = current_datetime.getMonth() + 1;
    if (currentmonth.toString().length < 2) {
      month = "0" + currentmonth
    } else {
      month = currentmonth
    }
    let formatted_date = day + "/" + month + "/" + current_datetime.getFullYear();
    if (!isNaN(day)) {
      return formatted_date;
    } else {
      return false;
    }
  }

  function checkTimeTaken() {
    var starthrs = document.getElementById("starthrs").options[document.getElementById("starthrs").selectedIndex].value;
    var endhrs = document.getElementById("endhrs").options[document.getElementById("endhrs").selectedIndex].value;
    var startmins = document.getElementById("startmins").options[document.getElementById("startmins").selectedIndex].value;
    var endmins = document.getElementById("endmins").options[document.getElementById("endmins").selectedIndex].value;
    if (!document.getElementById("dateTimeTaken").value) {
      document.getElementById("dateTimeTaken").setCustomValidity("Date required");
      document.getElementById("dateTimeTaken").reportValidity();
    } else if (starthrs == "0") {
      document.getElementById("starthrs").setCustomValidity("Please select valid start and end times");
      document.getElementById("starthrs").reportValidity();
    } else if (endhrs == "0") {
      document.getElementById("endhrs").setCustomValidity("Please select valid start and end times");
      document.getElementById("endhrs").reportValidity();
    } else if (parseInt(starthrs) > parseInt(endhrs)) {
      document.getElementById("starthrs").setCustomValidity("Start time cannot be later than end time.");
      document.getElementById("starthrs").reportValidity();
    } else {
      addTimeTaken();
    }
    return false;
  }

  function checkTimeOffered() {
    var starthrs = document.getElementById("starthrsOffered").options[document.getElementById("starthrsOffered").selectedIndex].value;
    var endhrs = document.getElementById("endhrsOffered").options[document.getElementById("endhrsOffered").selectedIndex].value;
    var startmins = document.getElementById("startminsOffered").options[document.getElementById("startminsOffered").selectedIndex].value;
    var endmins = document.getElementById("endminsOffered").options[document.getElementById("endminsOffered").selectedIndex].value;

    if (!document.getElementById("dateTimeOffered").value) {
      document.getElementById("dateTimeOffered").setCustomValidity("Date required");
      document.getElementById("dateTimeOffered").reportValidity();
    } else if (starthrs == "0") {
      document.getElementById("starthrsOffered").setCustomValidity("Please select valid start and end times");
      document.getElementById("starthrsOffered").reportValidity();
    } else if (endhrs == "0") {
      document.getElementById("endhrsOffered").setCustomValidity("Please select valid start and end times");
      document.getElementById("endhrsOffered").reportValidity();
    } else if (parseInt(starthrs) > parseInt(endhrs)) {
      document.getElementById("starthrsOffered").setCustomValidity("Start time cannot be later than end time.");
      document.getElementById("starthrsOffered").reportValidity();
    } else {
      addTimeOffered();
    }
    return false;
  }

  function deleteTimeTaken() {
    var sel = document.getElementById("takenhours");
    var opt = sel.options[sel.selectedIndex];
    var hrsTaken = opt.text.split("Total:")[1].trim().split(" ")[0];
    var minsTaken = opt.text.split("Total:")[1].trim().split(" ")[2];
    if (typeof minsTaken == "undefined") {
      minsTaken = "0";
    } else {
      minsTaken = opt.text.split("Total:")[1].trim().split(" ")[2];
    }
    var totalminstaken = parseInt(minsTaken) + (parseInt(hrsTaken) * 60)
    var runningtotalhrstaken = document.getElementById("runningtotalTimetaken").value.split(":")[0];
    var runningtotalminstaken = document.getElementById("runningtotalTimetaken").value.split(":")[1];
    if (runningtotalminstaken == "00") {
      runningtotalminstaken = "0";
    }
    var totalrunningtotalminstaken = (parseInt(runningtotalminstaken) + (parseInt(runningtotalhrstaken) * 60));
    runningtotalhrstaken = Math.trunc(parseInt(parseInt(totalrunningtotalminstaken) - parseInt(totalminstaken)) / 60);
    runningtotalminstaken = parseInt(parseInt(totalrunningtotalminstaken) - parseInt(totalminstaken)) % 60;
    document.getElementById("runningtotalTimetaken").value = runningtotalhrstaken + ":" + runningtotalminstaken;
    document.getElementById("hdntotalTimeTaken").value = runningtotalhrstaken + ":" + runningtotalminstaken;
    sel.remove(sel.selectedIndex);
    if (sel.options.length == 0) {
      document.getElementById("lnkdeleteTimeTaken").style.visibility = 'hidden';
      document.getElementById("runningtotalTimetaken").value = "";
      document.getElementById("timereason").style.display = 'none';
      document.getElementById("hoursoffreasonstatus").innerHTML = "";
      document.getElementById("unpaidleave").checked = false;
      document.getElementById("annualleave").checked = false;
      document.getElementById("makingup").checked = false;
      document.getElementById("timeOfferedSection").style.display = "none";
      document.getElementById("btnsubmit").disabled = true;
      document.getElementById("btnsubmit").style.backgroundColor = "#ccc";
      deleteTimeAllOffered();
    }
  }

  function deleteTimeOffered() {
    var sel = document.getElementById("offeredhours");
    var opt = sel.options[sel.selectedIndex];
    var hrsOffered = opt.text.split("Total:")[1].trim().split(" ")[0];
    var minsOffered = opt.text.split("Total:")[1].trim().split(" ")[2];
    if (typeof minsOffered == "undefined") {
      minsOffered = "0";
    } else {
      minsOffered = opt.text.split("Total:")[1].trim().split(" ")[2];
    }
    var totalminsoffered = parseInt(minsOffered) + (parseInt(hrsOffered) * 60)
    var runningtotalhrsoffered = document.getElementById("runningtotalTimeoffered").value.split(":")[0];
    var runningtotalminsoffered = document.getElementById("runningtotalTimeoffered").value.split(":")[1];
    if (runningtotalminsoffered == "00") {
      runningtotalminsoffered = "0";
    }
    var totalrunningtotalminsoffered = (parseInt(runningtotalminsoffered) + (parseInt(runningtotalhrsoffered) * 60));
    runningtotalhrsoffered = Math.trunc(parseInt(parseInt(totalrunningtotalminsoffered) - parseInt(totalminsoffered)) / 60);
    runningtotalminsoffered = parseInt(parseInt(totalrunningtotalminsoffered) - parseInt(totalminsoffered)) % 60;
    document.getElementById("runningtotalTimeoffered").value = runningtotalhrsoffered + ":" + runningtotalminsoffered;
    document.getElementById("hdntotalTimeOffered").value = runningtotalhrsoffered + ":" + runningtotalminsoffered;
    sel.remove(sel.selectedIndex);
    if (sel.options.length == 0) {
      document.getElementById("lnkdeleteTimeOffered").style.visibility = 'hidden';
      document.getElementById("runningtotalTimeoffered").value = "";
      document.getElementById("btnsubmit").disabled = true;
      document.getElementById("btnsubmit").style.backgroundColor = "#ccc";
    }
  }

  function deleteTimeAllOffered() {
    var sel = document.getElementById("offeredhours");
    while (sel.length > 0) {
      sel.remove(0);
    }
    document.getElementById("lnkdeleteTimeOffered").style.visibility = 'hidden';
    document.getElementById("runningtotalTimeoffered").value = "";
  }

  function setTotalHrsTaken() {
    document.getElementById("hdntotalTimeTaken").value = totalTimeTaken;
  }